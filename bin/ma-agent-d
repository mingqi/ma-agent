#!/usr/bin/env ruby

require 'daemons'
require 'pathname'



base_dir = Pathname(__FILE__).expand_path.dirname.dirname
puts base_dir

options = {
  :log_output => true,
  :dir_mode => :normal,
  :dir => base_dir.join('var').to_path
}

exec_path = base_dir.join('bin', 'ma-agent')
output_path = base_dir.join('var', 'ma-agent.log')
run_cmd = "#{exec_path.to_path} -o #{output_path.to_path}"

Daemons.run_proc('ma-agent', options) do
  exec(run_cmd) 
end